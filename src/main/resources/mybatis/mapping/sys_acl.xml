<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mfq.admin.web.dao.SysAclMapper">
	<sql id="selectsql">
		id, pid, name, url, `type`, `index`, created_at as
		createdAt
	</sql>
	<sql id="insertsql">
		pid, name, url, `type`, `index`, created_at
	</sql>

	<select id="findCount" resultType="Long">
		select count(1) from sys_acl
		<if test="type != null">
			where type=#{type}
		</if>
	</select>

	<select id="findAll" resultType="SysAcl">
		select
		<include refid="selectsql" />
		from sys_acl
		<if test="type != null">
			where type=#{type}
		</if>
		order by `index`
		<if test="start != null and limit != null">
			limit #{start}, #{limit}
		</if>
	</select>

	<select id="findById" resultType="SysAcl">
		select
		<include refid="selectsql" />
		from sys_acl where id=#{id}
	</select>

	<select id="findMenuChildren" resultType="SysAcl">
		select
		<include refid="selectsql" />
		from sys_acl where pid=#{pid} and type=#{type}
	</select>

	<insert id="insertOne" parameterType="SysAcl" useGeneratedKeys="true"
		keyProperty="id">
		<selectKey resultType="long" order="AFTER" keyProperty="id">
			SELECT LAST_INSERT_ID() AS uid
		</selectKey>
		insert into sys_acl(
		<include refid="insertsql" />
		)values (
		#{pid}, #{name}, #{url}, #{type}, #{index}, now()
		)
	</insert>

	<update id="updateOne">
		update sys_acl set pid=#{pid}, name=#{name},
		url=#{url}, type=#{type}, `index`=#{index}, created_at=#{createdAt}
		where id=#{id}
	</update>

	<delete id="deleteOne">
		delete from sys_acl where id=#{id}
	</delete>

</mapper>